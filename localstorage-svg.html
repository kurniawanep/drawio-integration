<html>
  <title>Draw.io Embedded (SVG DOM)</title>
  <head>
    <style type="text/css">
      html,
      body,
      #wrapper {
        height: 100%;
        width: 100%;
        margin: 0;
        padding: 0;
        border: 0;
      }
      table#wrapper {
        height: 75%;
      }
      #wrapper td {
        vertical-align: middle;
        text-align: center;
        cursor: pointer;
      }
      iframe {
        border: 0;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        width: 100%;
        height: 100%;
      }
    </style>
    <script type="text/javascript">
      var editor =
        "https://embed.diagrams.net/?embed=1&ui=min&spin=1&proto=json&configure=1";
      var initial = null;
      var name = null;

      function edit(elt) {
        var iframe = document.createElement("iframe");
        iframe.setAttribute("frameborder", "0");

        var close = function () {
          window.removeEventListener("message", receive);
          document.body.removeChild(iframe);
        };

        var draft = localStorage.getItem(".draft-" + name);

        console.log(draft);

        if (draft != null) {
          draft = JSON.parse(draft);

          if (
            !confirm(
              "A version of this page from " +
                new Date(draft.lastModified) +
                " is available. Would you like to continue editing?"
            )
          ) {
            draft = null;
          }
        }

        var receive = function (evt) {
          if (evt.data.length > 0) {
            var msg = JSON.parse(evt.data);

            // If configure=1 URL parameter is used the application
            // waits for this message. For configuration options see
            // https://desk.draw.io/support/solutions/articles/16000058316
            if (msg.event == "configure") {
              // Configuration example
              iframe.contentWindow.postMessage(
                JSON.stringify({
                  action: "configure",
                  config: {
                    defaultFonts: [
                      "Humor Sans",
                      "Helvetica",
                      "Times New Roman",
                    ],
                  },
                }),
                "*"
              );
            } else if (msg.event == "init") {
              if (draft != null) {
                iframe.contentWindow.postMessage(
                  JSON.stringify({
                    action: "load",
                    autosave: 1,
                    xml: draft.xml,
                  }),
                  "*"
                );
                iframe.contentWindow.postMessage(
                  JSON.stringify({ action: "status", modified: true }),
                  "*"
                );
              } else {
                // Avoids unescaped < and > from innerHTML for valid XML
                var svg = new XMLSerializer().serializeToString(elt.firstChild);
                iframe.contentWindow.postMessage(
                  JSON.stringify({ action: "load", autosave: 1, xml: svg }),
                  "*"
                );
              }
            } else if (msg.event == "export") {
              // Extracts SVG DOM from data URI to enable links
              var svg = atob(msg.data.substring(msg.data.indexOf(",") + 1));
              elt.innerHTML = svg;
              localStorage.setItem(
                name,
                JSON.stringify({ lastModified: new Date(), data: svg })
              );
              localStorage.removeItem(".draft-" + name);
              draft = null;
              close();
            } else if (msg.event == "autosave") {
              localStorage.setItem(
                ".draft-" + name,
                JSON.stringify({ lastModified: new Date(), xml: msg.xml })
              );
            } else if (msg.event == "save") {
              iframe.contentWindow.postMessage(
                JSON.stringify({
                  action: "export",
                  format: "xmlsvg",
                  xml: msg.xml,
                  spin: "Updating page",
                }),
                "*"
              );
              localStorage.setItem(
                ".draft-" + name,
                JSON.stringify({ lastModified: new Date(), xml: msg.xml })
              );
            } else if (msg.event == "exit") {
              localStorage.removeItem(".draft-" + name);
              draft = null;
              close();
            }
          }
        };

        window.addEventListener("message", receive);
        iframe.setAttribute("src", editor);
        document.body.appendChild(iframe);
      }

      function load() {
        initial = document.getElementById("diagram").innerHTML;
        start();
      }

      function start() {
        name =
          window.location.hash.length > 1
            ? window.location.hash.substring(1)
            : "default";
        var current = localStorage.getItem(name);

        if (current != null) {
          var entry = JSON.parse(current);
          document.getElementById("diagram").innerHTML = entry.data;
        } else {
          document.getElementById("diagram").innerHTML = initial;
        }
      }

      window.addEventListener("hashchange", start);
    </script>
  </head>
  <body onload="load();">
    <table id="wrapper">
      <tr>
        <td id="diagram" title="Double click to edit" ondblclick="edit(this);">
          
          <svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" width=\"121px\" height=\"61px\" viewBox=\"-0.5 -0.5 121 61\" content=\"&lt;mxfile host=&quot;embed.diagrams.net&quot; modified=&quot;2024-05-20T14:20:04.612Z&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36&quot; etag=&quot;k_UVwxYamkv0rbBUEtPB&quot; version=&quot;24.4.4&quot; type=&quot;embed&quot;&gt;&lt;diagram id=&quot;0UL2xKdEgXqnP9eGfPJW&quot; name=&quot;Page-1&quot;&gt;jZJNb8MgDIZ/DfcktF13XdZ2l51y2BkFLyCROKLkq79+ZJh8qJq0HCLzvLaBFzOe1+PNilZ9ogTDskSOjL+zLHs9nP1/BlMAxxcCldUyoHQFhX4AwYRopyXcd4kO0Tjd7mGJTQOl2zFhLQ77tG80+11bUcETKEphnumXlk4Fej4mK/8AXam4c5qQUouYTOCuhMRhg/iF8dwiuhDVYw5m9i76Euquf6jLwSw07j8FWSjohenobiw7GV/6JnXvw2oOH+GLiu+2EekebormWOwaCXP/1MuD0g6KVpSzOvhp8Ey52pD8fF66Qg/WwbhBdP4bYA3OTj6F1AMnL2mYlikZ1qdJo99q8ywnYoKmoVpar4b5gDyLy/VtfrXNgPPLDw==&lt;/diagram&gt;&lt;/mxfile&gt;\"><defs/><g><g><rect x=\"0\" y=\"0\" width=\"120\" height=\"60\" rx=\"9\" ry=\"9\" fill=\"rgb(255, 255, 255)\" stroke=\"rgb(0, 0, 0)\" pointer-events=\"all\"/></g><g><g transform=\"translate(-0.5 -0.5)\"><switch><foreignObject pointer-events=\"none\" width=\"100%\" height=\"100%\" requiredFeatures=\"http://www.w3.org/TR/SVG11/feature#Extensibility\" style=\"overflow: visible; text-align: left;\"><div xmlns=\"http://www.w3.org/1999/xhtml\" style=\"display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 30px; margin-left: 1px;\"><div data-drawio-colors=\"color: rgb(0, 0, 0); \" style=\"box-sizing: border-box; font-size: 0px; text-align: center;\"><div style=\"display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;\"><div>zzzzzzz</div></div></div></div></foreignObject><text x=\"60\" y=\"34\" fill=\"rgb(0, 0, 0)\" font-family=\"Helvetica\" font-size=\"12px\" text-anchor=\"middle\">zzzzzzz</text></switch></g></g></g><switch><g requiredFeatures=\"http://www.w3.org/TR/SVG11/feature#Extensibility\"/><a transform=\"translate(0,-5)\" xlink:href=\"https://www.drawio.com/doc/faq/svg-export-text-problems\" target=\"_blank\"><text text-anchor=\"middle\" font-size=\"10px\" x=\"50%\" y=\"100%\">Text is not SVG - cannot display</text></a></switch></svg>
        </td>
      </tr>
    </table>
  </body>
</html>